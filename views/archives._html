#!/usr/bin/ruby1.9.1
# encoding: utf-8
require 'wunderbar'

_html lang: 'en' do
  _head do
    _title "Sam Ruby: #{@date.strftime('%B %Y')}"
    _link rel: 'stylesheet', href: '/css/blogy.css', type: 'text/css'
  end

  _body do
    _header do
      _h1 { _a 'intertwingly', href: 'http://intertwingly.net/blog/' }
      _form method: 'get', action: 'http://intertwingly.net/blog/' do
        _label 'Search', for: 'q'
        _input.q! type: 'search', name: 'q', placeholder: 'Search', value: ''
      end
      _p "Itâ€™s just data"
    end

    _table_.calendar do
      _caption do
        _a @date.strftime('%B %Y')
      end

      headings = %w(Sunday Monday Tuesday Wednesday Thursday Friday Saturday)

      _thead_ do
        _tr do
          headings.each {|day| _th day}
        end
      end

      _tbody do
        @weeks.each do |week, dates|
          dates = Hash[dates.map {|date| [date.strftime('%A'), date.day]}]
          _tr_ do
            headings.each do |day|
              if dates[day]
                _td { _div.day dates[day] }
              else
                _td
              end
            end
          end
        end
      end
    end

    _div.leftbar do
      prev_month = @date - 1
      _h2 do
        _a prev_month.strftime('%B %Y'), href: prev_month.strftime('../%Y/%m')
      end
    end
    _div.rightbar do
      next_month = @date + 31
      _h2 do
        _a next_month.strftime('%B %Y'), href: next_month.strftime('../%Y/%m')
      end
    end

    _footer_ do
      _ul do
        _li do
          _ 'HTTP'
          _ul do
            _li { _a 'RFC 2616', href: 'http://tools.ietf.org/html/rfc2616' }
            _li { _a 'httpbis', href: 'http://www.ietf.org/html.charters/httpbis-charter.html' }
            _li do
              _ 'URI'
              _ul do
                _li { _a 'RFC 3986', href: 'http://tools.ietf.org/html/rfc3986' }
                _li { _a 'URI Template', href: 'http://bitworking.org/projects/URI-Templates/' }
              end
            end
          end
        end
        _li do
          _ 'HTML'
          _ul do
            _li { _a 'Working Group', href: 'http://www.w3.org/html/wg/' }
            _li { _a 'WHATWG', href: 'http://www.whatwg.org/' }
            _li do
              _ 'Specs'
              _ul do
                _li { _a 'HTML 4.01', href: 'http://www.w3.org/TR/REC-html40/' }
                _li { _a 'XHTML 1.0', href: 'http://www.w3.org/TR/xhtml1/' }
              end
            end
            _li do
              _ 'Drafts'
              _ul do
                _li { _a 'HTML 5', href: 'http://www.w3.org/html/wg/html5/' }
                _li { _a 'Markup Language', href: 'http://www.w3.org/html/wg/markup-spec/' }
                _li { _a 'Web Workers', href: 'http://dev.w3.org/html5/offline-webapps/' }
                _li { _a 'HTML Author', href: 'http://dev.w3.org/html5/html-author/' }
                _li { _a 'RDFa', href: 'http://dev.w3.org/html5/rdfa/Overview.html#rdfa' }
                _li { _a 'Publication Notes', href: 'http://dev.w3.org/html5/pubnotes/' }
                _li { _a 'HTML4 Differences', href: 'http://dev.w3.org/html5/html4-differences/' }
                _li { _a 'Offline Web Applications', href: 'http://dev.w3.org/html5/offline-webapps/' }
                _li { _a 'Design Principles', href: 'http://dev.w3.org/html5/html-design-principles/' }
                _li { _a 'Web Forms 2.0', href: 'http://dev.w3.org/html5/web-forms-2/' }
              end
            end
          end
        end
        _li do
          _ 'Atom'
          _ul do
            _li { _a 'Format', href: 'http://www.atomenabled.org/developers/syndication/atom-format-spec.php' }
            _li { _a 'Protocol', href: 'http://www.atomenabled.org/developers/protocol/atom-protocol-spec.php' }
            _li do
              _ 'Extensions'
              _ul do
                _li { _a 'Threading', href: 'http://tools.ietf.org/html/rfc4685' }
                _li { _a 'Paging and Archiving', href: 'http://tools.ietf.org/html/rfc5005' }
                _li { _a 'License', href: 'http://tools.ietf.org/html/rfc4946' }
              end
            end
          end
        end
      end
      _svg viewBox: '0 0 100 100' do
        _defs 'xmlns:xlink' => 'http://www.w3.org/1999/xlink' do
          _radialGradient.i1! fx: '.4', fy: '.2', r: '.7' do
            _stop stop_color: '#FE8', offset: '0'
            _stop stop_color: '#D70', offset: '1'
          end
          _radialGradient.i2! fx: '.8', fy: '.5', 'xlink:href' => '#i1'
          _radialGradient.i3! fx: '.5', fy: '.9', 'xlink:href' => '#i1'
          _radialGradient.i4! fx: '.1', fy: '.5', 'xlink:href' => '#i1'
        end
        _g stroke: '#940' do
          _path d: 'M73,29c-37-40-62-24-52,4l6-7c-8-16,7-26,42,9z', fill: 'url(#i1)'
          _path d: 'M47,8c33-16,48,21,9,47l-6-5c38-27,20-44,5-37z', fill: 'url(#i2)'
          _path d: 'M77,32c22,30,10,57-39,51l-1-8c3,3,67,5,36-36z', fill: 'url(#i3)'
          _path d: 'M58,84c-4,20-38-4-8-24l-6-5c-36,43,15,56,23,27z', fill: 'url(#i4)'
          _path d: 'M40,14c-40,37-37,52-9,68l1-8c-16-13-29-21,16-56z', fill: 'url(#i1)'
          _path d: 'M31,33c19,23,20,7,35,41l-9,1.7c-4-19-8-14-31-37z', fill: 'url(#i2)'
        end
      end
    end
  end
end
